@if (game) {
  <div class="game-detail">
    <div class="header">
      <img [src]="game.backgroundImage" [alt]="game.name" class="cover" />
    </div>

    <div class="info">
      <h1>{{ game.name }}</h1>
    
      <div class="icons">

        <app-game-actions
        class="icons"
        [game]="game"
        ></app-game-actions>
        
        <button class="btn-review" (click)="modalManager.openReviewModal(game)" [disabled]="!game">
          <img src="/assets/images/icons/pencil.svg" alt=""> Review
        </button>
      </div>
    </div>

    <div class="description">
      <div class="description-content">
        <div class="text">
          <p [innerHTML]="game.description"></p>
        </div>
        <div class="media-info">
          <div class="image">
            <img [src]="game.backgroundImage" [alt]="game.name" />
          </div>
          
          @if(game.rating) {
            <p class="rating">
              Community rating: <span>{{ game.rating }}</span>
              <img class="star" src="../../../assets/images/icons/star-filled.svg" alt="⭐">
            </p>
          }
          
          @if (game.playtime && game.playtime > 0) {
            <p class="duration">
              Average playtime: <span>{{ game.playtime }} hours</span>
            </p>
          }

        </div>
      </div>
    </div>


    <div class="additional-info">
      <div class="info-item">
        <h3>Release Date</h3>
        <p>{{ game.released || 'N/A' }}</p>
      </div>

      <div class="info-item">
        <h3>Genres</h3>
        <p>
          @for (g of game.genres; track g) {
            {{ g.name }}@if (!$last) {, }
          }
        </p>
      </div>

      <div class="info-item">
        <h3>Developers</h3>
        <p>
          @for (d of game.developers; track d) {
            {{ d.name }}@if (!$last) {, }
          }
        </p>
      </div>

      <div class="info-item">
        <h3>Publishers</h3>
        <p>
          @for (p of game.publishers; track p) {
            {{ p.name }}@if (!$last) {, }
          }
        </p>
      </div>

      @if (game.website) {
        <div class="info-item">
          <h3>Official Site</h3>
          <p><a [href]="game.website" target="_blank">{{ game.website }}</a></p>
        </div>
      }

      @if (game.stores && game.stores.length > 0) {
        <div class="info-item">
          <h3>Buy On</h3>
          <p>
            @for (store of game.stores; track store) {
              <a [href]="store.url" target="_blank">{{ store.store.name }}</a>
              @if (!$last) {, }
            }
          </p>
        </div>
      }
    </div>
  </div>
} @else {
  <p>Loading game details...</p>
}

<div class="reviews">

  <div class="reviews-header">
    <h2>Reviews</h2>

    <button
      *ngIf="reviews.length > 4 && !showAll"
      class="see-all-btn"
      (click)="showAll = true"
    >
      See all reviews →
    </button>

    <button
      *ngIf="showAll"
      class="see-all-btn back"
      (click)="showAll = false"
    >
      ← Show less
    </button>
  </div>

  <p *ngIf="reviews.length === 0" class="no-reviews">No reviews yet.</p>

<div class="reviews-grid" *ngIf="!showAll && limitedReviews.length > 0">
  <div class="review-card" *ngFor="let r of limitedReviews">
    <div class="review-header">
      <img class="avatar" [src]="r.profileImage || placeholderImage" alt="User avatar" />
      <div class="user-meta">
        <h4>{{ r.username }}</h4>
        <small class="date">{{ r.createdAt | date:'mediumDate' }}</small>
      </div>
    </div>
    <div class="review-meta">
      <span *ngIf="r.rating" class="badge rating">⭐ {{ r.rating }}/5</span>
      <span *ngIf="r.playtime" class="badge playtime">⏱ {{ r.playtime }}h</span>
    </div>
    <p class="comment">{{ r.review }}</p>
  </div>
</div>

<div class="reviews-grid" *ngIf="showAll && reviews.length > 0">
  <div class="review-card" *ngFor="let r of reviews">
    <div class="review-header">
      <img class="avatar" [src]="r.profileImage || placeholderImage" alt="User avatar" />
      <div class="user-meta">
        <h4>{{ r.username }}</h4>
        <small class="date">{{ r.createdAt | date:'mediumDate' }}</small>
      </div>
    </div>
    <div class="review-meta">
      <span *ngIf="r.rating" class="badge rating">⭐ {{ r.rating }}/5</span>
      <span *ngIf="r.playtime" class="badge playtime">⏱ {{ r.playtime }}h</span>
    </div>
    <p class="comment">{{ r.review }}</p>
  </div>
</div>

</div>

